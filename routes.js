// Generated by CoffeeScript 1.10.0

/* routes.js */

(function() {
  var crypto, db, router;

  router = require('express').Router();

  crypto = require('crypto');

  db = require('./app').db;

  router.get('/', function(req, res) {
    return res.redirect('/start');
  });

  router.get('/start', function(req, res) {
    return res.render('start');
  });

  router.post('/start', function(req, res) {
    var boardname, date, fingerprint, shasum;
    boardname = req.body.boardname;
    shasum = crypto.createHash('sha1');
    date = new Date();
    shasum.update(boardname + date);
    fingerprint = shasum.digest('hex');
    db.collection('boards').insert({
      fingerprint: fingerprint,
      data: JSON.stringify({
        name: boardname,
        stickylist: []
      })
    });
    return res.redirect("/board/" + fingerprint);
  });

  router.get('/board', function(req, res) {
    return res.redirect('/start');
  });

  router.get('/board/:fingerprint', function(req, res) {
    return res.render('board');
  });

  router.post('/board/:fingerprint', function(req, res) {});

  module.exports = router;

}).call(this);
